select i_imoveis, campo1+'.'+campo2+'.'+campo3+'.'+campo4 as incricao, imoveis.unidade, (if imoveis.unidade=0 then 'T' else 'P' endif) as tipo, imoveis.rural, imoveis.desativado, 
imoveis.i_pessoas, pessoas.tipo_pessoa, pessoas_fisicas.cpf, isnull(pessoas_fisicas.rg,'') as rg, isnull(pessoas.ddd,'') as ddd, isnull(pessoas.telefone,'') as telefone, pessoas.nome, imoveis.i_ruas, ruas.nome, imoveis.i_bairros, bairros.nome, imoveis.numero,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,100,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,100,2019) and ano=2019) endif as isento_100,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,200,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,200,2019) and ano=2019) endif as titulacao_200,
isnull((select descricao from bethadba.bci where i_item=dbf_fc_retbci_valor(imoveis.i_imoveis,396,2019)),'') as titulo_396,
isnull((select descricao from bethadba.bci where i_item=dbf_fc_retbci_valor(imoveis.i_imoveis,496,2019)),'') as livro_496,
isnull((select descricao from bethadba.bci where i_item=dbf_fc_retbci_valor(imoveis.i_imoveis,596,2019)),'') as folha_396,
isnull((select descricao from bethadba.bci where i_item=dbf_fc_retbci_valor(imoveis.i_imoveis,696,2019)),'') as ano_696,
dbf_fc_retbci_valor(imoveis.i_imoveis,799,2019) as areaTerreno_799,
isnull(dbf_fc_retbci_valor(imoveis.i_imoveis,899,2019),0) as areaEdificada_899,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,900,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,900,2019) and ano=2019) endif as padrao_900,
isnull(dbf_fc_retbci_valor(imoveis.i_imoveis,1098,2019),0) as unidadesHabitacionais_1098,
isnull(dbf_fc_retbci_valor(imoveis.i_imoveis,1199,2019),0) as valorVenalTerreno,
isnull(dbf_fc_retbci_valor(imoveis.i_imoveis,1299,2019),0) as valorVenalEdificacao,
isnull(dbf_fc_retbci_valor(imoveis.i_imoveis,1399,2019),0) as valorVenalImovel,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,1400,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,1400,2019) and ano=2019) endif as agua_1400,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,1500,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,1500,2019) and ano=2019) endif as asfalto_1500,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,1600,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,1600,2019) and ano=2019) endif as luz_1600,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,1700,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,1700,2019) and ano=2019) endif as coletaLixo_1700,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,1800,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,1800,2019) and ano=2019) endif as iluminacaoPublica_1800,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,1900,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,1900,2019) and ano=2019) endif as esgoto_1900,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,2000,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,2000,2019) and ano=2019) endif as telefone_2000,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,2100,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,2100,2019) and ano=2019) endif as ocupacao_2100,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,2200,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,2200,2019) and ano=2019) endif as utilizacao_2200,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,2300,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,2300,2019) and ano=2019) endif as situacao_2300,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,2400,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,2400,2019) and ano=2019) endif as nivelamento_2400,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,2500,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,2500,2019) and ano=2019) endif as relevo_2500,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,2600,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,2600,2019) and ano=2019) endif as testrutura_2600,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,2700,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,2700,2019) and ano=2019) endif as acabamentoExterno_2700,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,2800,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,2800,2019) and ano=2019) endif as acabamentoInterno_2800,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,2900,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,2900,2019) and ano=2019) endif as piso_2900,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,3000,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,3000,2019) and ano=2019) endif as cobertura_3000,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,3100,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,3100,2019) and ano=2019) endif as forro_3100,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,3200,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,3200,2019) and ano=2019) endif as instalacaoEletrica_3200,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,3300,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,3300,2019) and ano=2019) endif as instalacaoSanitaria_3300,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,3400,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,3400,2019) and ano=2019) endif as instalacaoHidraulica_3400,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,3500,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,3500,2019) and ano=2019) endif as fossa_3500,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,3600,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,3600,2019) and ano=2019) endif as conservacao_3600,
isnull(dbf_fc_retbci_valor(imoveis.i_imoveis,3799,2019),'') as testada_3799,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,3800,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,3800,2019) and ano=2019) endif as meioFio_3800,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,3900,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,3900,2019) and ano=2019) endif as calcamento_3900,
dbf_fc_retbci_valor(imoveis.i_imoveis,4099,2019) as valorM2Terreno_4099,
dbf_fc_retbci_valor(imoveis.i_imoveis,4199,2019) as valorM2Edificacao_4099,
dbf_fc_retbci_valor(imoveis.i_imoveis,4299,2019) as aliquota_4299,
dbf_fc_retbci_data(imoveis.i_imoveis,4397,2019) as dataUltimaVistoria_439,
if isnull(dbf_fc_existe_opc_bci(imoveis.i_imoveis,4400,2019),0)=0 then '' else (select descricao from bethadba.bci where i_item=dbf_fc_existe_opc_bci(imoveis.i_imoveis,4400,2019) and ano=2019) endif as rota_4400

from bethadba.imoveis inner join bethadba.pessoas on pessoas.i_pessoas=imoveis.i_pessoas 
join bethadba.pessoas_fisicas on pessoas_fisicas.i_pessoas=pessoas.i_pessoas
join bethadba.ruas on ruas.i_ruas=imoveis.i_ruas
join bethadba.bairros on bairros.i_bairros=imoveis.i_bairros

--   select * from bethadba.opcoes_bci where ano=2019 and i_imoveis=178 order by 1